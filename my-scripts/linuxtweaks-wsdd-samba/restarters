# Reload systemd to ensure the latest unit files are loaded
systemctl daemon-reexec
systemctl daemon-reload

# Enable all relevant services to start on boot (including Samba & WSDD)
systemctl enable --now ntp-check.service ntp-check.timer linuxTweaks-autostart.service \
  linuxtweaks-cake.service linuxtweaks-cake-resume.service preload.service

systemctl enable --now smb.service nmb.service wsdd.service wsdd-sleep.service wsdd-starter.service

# Stop all services and timers to ensure a clean restart
systemctl stop ntp-check.timer ntp-check.service \
  linuxTweaks-autostart.service linuxtweaks-cake.service linuxtweaks-cake-resume.service preload.service \
  wsdd.service wsdd-sleep.service wsdd-starter.service

sleep 1

# Restart all services and timers
systemctl start ntp-check.service ntp-check.timer \
  linuxTweaks-autostart.service linuxtweaks-cake.service linuxtweaks-cake-resume.service preload.service \
  wsdd.service wsdd-sleep.service wsdd-starter.service

# Reset any failed states for all services and timers
systemctl reset-failed ntp-check.service linuxTweaks-autostart.service \
  linuxtweaks-cake.service linuxtweaks-cake-resume.service preload.service \
  wsdd-sleep.service wsdd-starter.service


